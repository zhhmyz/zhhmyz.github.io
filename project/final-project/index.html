<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <title>Final project: Predicting discharge locations using MIMIC-III dataset | Mengyue Han</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1">
    <meta name="generator" content="Hugo 0.74.3" />
    
    
      <META NAME="ROBOTS" CONTENT="NOINDEX, NOFOLLOW">
    

    
    
      <link href="/dist/css/app.4fc0b62e4b82c997bb0041217cd6b979.css" rel="stylesheet">
    

    

    
      
<link rel="shortcut icon" href="/favicon_io/favicon-16x16.png" type="image/x-icon" />



    

    
    
    <meta property="og:title" content="Final project: Predicting discharge locations using MIMIC-III dataset" />
<meta property="og:description" content="Final project" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://zhhmyz.github.io/project/final-project/" />
<meta property="article:published_time" content="2020-11-18T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-11-18T00:00:00+00:00" />
<meta itemprop="name" content="Final project: Predicting discharge locations using MIMIC-III dataset">
<meta itemprop="description" content="Final project">
<meta itemprop="datePublished" content="2020-11-18T00:00:00+00:00" />
<meta itemprop="dateModified" content="2020-11-18T00:00:00+00:00" />
<meta itemprop="wordCount" content="1237">



<meta itemprop="keywords" content="" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Final project: Predicting discharge locations using MIMIC-III dataset"/>
<meta name="twitter:description" content="Final project"/>

	
  </head>

  <body class="ma0 avenir bg-near-white">

    
   
  

  <header>
    <div class="bg-navy">
      <nav class="pv3 ph3 ph4-ns" role="navigation">
  <div class="flex-l justify-between items-center center">
    <a href="/" class="f3 fw2 hover-white no-underline white-90 dib">
      
        Mengyue Han
      
    </a>
    <div class="flex-l items-center">
      

      
        <ul class="pl0 mr3">
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/blog/" title="Blogs page">
              Blogs
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/posts/" title="Posts page">
              Posts
            </a>
          </li>
          
          <li class="list f5 f4-ns fw4 dib pr3">
            <a class="hover-white no-underline white-90" href="/project/" title="Projects page">
              Projects
            </a>
          </li>
          
        </ul>
      
      








<a href="https://github.com/zhhmyz/zhhmyz.github.io" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>








    </div>
  </div>
</nav>

    </div>
  </header>



    <main class="pb7" role="main">
      
  
  <article class="flex-l flex-wrap justify-between mw8 center ph3">
    <header class="mt4 w-100">
      <aside class="instapaper_ignoref b helvetica tracked">
          
        PROJECTS
      </aside>
      




  <div id="sharing" class="mt3">

    
    <a href="https://www.facebook.com/sharer.php?u=https://zhhmyz.github.io/project/final-project/" class="facebook no-underline" aria-label="share on Facebook">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M28.765,50.32h6.744V33.998h4.499l0.596-5.624h-5.095  l0.007-2.816c0-1.466,0.14-2.253,2.244-2.253h2.812V17.68h-4.5c-5.405,0-7.307,2.729-7.307,7.317v3.377h-3.369v5.625h3.369V50.32z   M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;"/></svg>

    </a>

    
    
    <a href="https://twitter.com/share?url=https://zhhmyz.github.io/project/final-project/&amp;text=Final%20project:%20Predicting%20discharge%20locations%20using%20MIMIC-III%20dataset" class="twitter no-underline" aria-label="share on Twitter">
      <svg height="32px"  style="enable-background:new 0 0 67 67;" version="1.1" viewBox="0 0 67 67" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M37.167,22.283c-2.619,0.953-4.274,3.411-4.086,6.101  l0.063,1.038l-1.048-0.127c-3.813-0.487-7.145-2.139-9.974-4.915l-1.383-1.377l-0.356,1.017c-0.754,2.267-0.272,4.661,1.299,6.271  c0.838,0.89,0.649,1.017-0.796,0.487c-0.503-0.169-0.943-0.296-0.985-0.233c-0.146,0.149,0.356,2.076,0.754,2.839  c0.545,1.06,1.655,2.097,2.871,2.712l1.027,0.487l-1.215,0.021c-1.173,0-1.215,0.021-1.089,0.467  c0.419,1.377,2.074,2.839,3.918,3.475l1.299,0.444l-1.131,0.678c-1.676,0.976-3.646,1.526-5.616,1.568  C19.775,43.256,19,43.341,19,43.405c0,0.211,2.557,1.397,4.044,1.864c4.463,1.377,9.765,0.783,13.746-1.568  c2.829-1.673,5.657-5,6.978-8.221c0.713-1.716,1.425-4.851,1.425-6.354c0-0.975,0.063-1.102,1.236-2.267  c0.692-0.678,1.341-1.419,1.467-1.631c0.21-0.403,0.188-0.403-0.88-0.043c-1.781,0.636-2.033,0.551-1.152-0.402  c0.649-0.678,1.425-1.907,1.425-2.267c0-0.063-0.314,0.042-0.671,0.233c-0.377,0.212-1.215,0.53-1.844,0.72l-1.131,0.361l-1.027-0.7  c-0.566-0.381-1.361-0.805-1.781-0.932C39.766,21.902,38.131,21.944,37.167,22.283z M33,64C16.432,64,3,50.569,3,34S16.432,4,33,4  s30,13.431,30,30S49.568,64,33,64z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/></svg>

    </a>

    
    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://zhhmyz.github.io/project/final-project/&amp;title=Final%20project:%20Predicting%20discharge%20locations%20using%20MIMIC-III%20dataset" class="linkedin no-underline" aria-label="share on LinkedIn">
      <svg  height="32px"  style="enable-background:new 0 0 65 65;" version="1.1" viewBox="0 0 65 65" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
  <path d="M50.837,48.137V36.425c0-6.275-3.35-9.195-7.816-9.195  c-3.604,0-5.219,1.983-6.119,3.374V27.71h-6.79c0.09,1.917,0,20.427,0,20.427h6.79V36.729c0-0.609,0.044-1.219,0.224-1.655  c0.49-1.22,1.607-2.483,3.482-2.483c2.458,0,3.44,1.873,3.44,4.618v10.929H50.837z M22.959,24.922c2.367,0,3.842-1.57,3.842-3.531  c-0.044-2.003-1.475-3.528-3.797-3.528s-3.841,1.524-3.841,3.528c0,1.961,1.474,3.531,3.753,3.531H22.959z M34,64  C17.432,64,4,50.568,4,34C4,17.431,17.432,4,34,4s30,13.431,30,30C64,50.568,50.568,64,34,64z M26.354,48.137V27.71h-6.789v20.427  H26.354z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>

    </a>
  </div>


      <h1 class="f1 athelas mt3 mb1">Final project: Predicting discharge locations using MIMIC-III dataset</h1>
      
      
      <time class="f6 mv4 dib tracked" datetime="2020-11-18T00:00:00Z">November 18, 2020</time>

      
      
        <span class="f6 mv4 dib tracked"> - 6 minutes read</span>
        <span class="f6 mv4 dib tracked"> - 1237 words</span>
      
    </header>
    <div class="nested-copy-line-height lh-copy serif f4 nested-links nested-img mid-gray pr3-l w-two-90-l"><h3 id="project-description">Project description</h3>
<p>We used <a href="https://mimic.physionet.org/about/mimic/">MIMIC-III</a> dataset which is comprised of ~60,000 deidentified health-related data to classify and predict patients&rsquo; discharge location. We are particularly interested in this primary outcome because discharge location is a good representation of healthcare utilizations. For this dataset, we mainly focused on discharge location SNF which represents for skilled nursing facility because patients discharged to a SNF will continue consume more hospital resources, while patients discharged to home will not. Therefore, precise prediction of this outcome of interest will provide hospital an early information about utilization management.</p>
<h3 id="my-responsibility">My responsibility</h3>
<ul>
<li>Get familiar with original dataset and data cleaning process.</li>
<li>Tidy one version of dataset without one-hot encoding of all categorical variables, for the purpose of creating cross tables and visualizations in exploratory data analysis.</li>
<li>Perform predictive modeling Naive Bayes and KNN classifers with hyperparameter tuning.</li>
<li>Build EDA page of our dashboard (cooperated with <em>Zhenhui Xu</em>)</li>
<li>Dashboard debug (cooperated with other team members).</li>
</ul>
<h3 id="techinical-mastery">Techinical mastery</h3>
<ul>
<li>Effective use of version control: merge, pull, push, commit, set up my own branch</li>
<li>Data analysis and visualization: pandas, numpy, plotly, matplotlib, seaborn</li>
<li>Machine learning: sklearn, optuna, model training and evaluation</li>
<li>Data product: dash</li>
</ul>
<h3 id="data-product">Data product</h3>
<ul>
<li>Multi-Page Dashboard held on Cloud Platform</li>
<li>Online ML Algorithm for Real-Time Prediction</li>
</ul>
<h3 id="audience">Audience</h3>
<ul>
<li>Our platform aims to serve the hospital administration team, the inquisitive researchers and curious patients</li>
<li>The multi-page dashboard serves as a tool to monitor occupancy and  clinical results of patients, and provide comprehensive demonstration</li>
<li>The online ML prediction model provides real-time results of clinical  outcome, which will aid in decision-making process of patients and  doctors</li>
</ul>
<h3 id="project-process">Project process</h3>
<h4 id="-identify-dataset-and-science-problem-to-solve">&gt; Identify dataset and science problem to solve</h4>
<p>At the beginning of group discussion, we chose this MIMIC-III dataset attracted by its large sample size and health-related data nature. We decided to predict patients&rsquo; <strong>hospital length of stay</strong> initially using demographic data and baseline measurements. It will be both helpful to patients and hospital if we can precise predict how long a patient would stay in the hospital when they are admitted. However, after we conducted some exploratory data analysis and got more familar with the data, we decided to change our outcome to patients&rsquo; discharge location, considering potential lower accuray in predicting a continuous outcome and small number of baseline predictors. <strong>Discharge location</strong> also has great practical meaning for hostipal utlizations.</p>
<h4 id="-data-management-and-clean-up">&gt; Data management and clean up</h4>
<ol>
<li>
<p>Query dataset from Google Big Query</p>
<p>We combined tables of <em>ADMISSIONS</em>, <em>PATIENTS</em>, vitals and labs data queried from Google Big Query as our final dataset. This part is finished by <em>Zhenhui Xu</em>. In the end, our predictors include patients&rsquo; demographic information, vitals and labs measurements</p>
</li>
<li>
<p>Reformat data and subset categories</p>
<ul>
<li>Convert <code>dtypes</code> of time related variables to date time</li>
<li>Patient whose age is greater than 89 will be assigned age 300 to deidentify patient&rsquo;s information. Therefore, <strong>we convert the age of those patients who are older than 89 years old to 89 years old</strong>.</li>
</ul>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;ADMITTIME&#34;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">to_datetime</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ADMITTIME</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;DISCHTIME&#34;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">to_datetime</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DISCHTIME</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;Hosp_LOS&#34;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DISCHTIME</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ADMITTIME</span>
<span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;DOB&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">to_datetime</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DOB</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;age&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">ADMITTIME</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">dt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">year</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">DOB</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">dt</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">year</span>
<span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;age&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">where</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">age</span><span style="color:#ce5c00;font-weight:bold">&gt;</span><span style="color:#0000cf;font-weight:bold">89</span><span style="color:#000;font-weight:bold">,</span><span style="color:#0000cf;font-weight:bold">89</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">age</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div><ul>
<li>
<p>Transform target variable <em>DISCHARGE_LOCATION</em> to four levels:</p>
<p><em>DEAD/EXPIRED, HOME, SNF, Other facility</em>. The outcome is unbalanced distributed with around 60% of patients are discharged to <em>HOME</em>

  
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>





<div id="/plotly/pie.json" class="plotly" style="height:300px"></div>
<script>
Plotly.d3.json("/plotly/pie.json", function(err, fig) {
    Plotly.plot('\/plotly\/pie.json', fig.data, fig.layout, {responsive: true});
});
</script></p>
</li>
<li>
<p>Subset 5 types of RELIGION and change the other types to &lsquo;RELIGION_others&rsquo;:</p>
<p>Popular ones with dietary restrictions: BUDDHIST, JEWISH, HINDU, MUSLIM, 7TH DAY ADVENTIST, RELIGION_others</p>
</li>
<li>
<p>Subset 4 types from <em>ETHNICITY</em>:</p>
<p>ASIAN, WHITE, BLACK, ETHNICITY_Others</p>
</li>
<li>
<p>Subset top 10 <em>DIAGNOSIS</em></p>
</li>
</ul>
</li>
<li>
<p>Imputation</p>
<ul>
<li>
<p>Impute NA with 0 value for <em>EDREGTIME</em> and <em>EDOUTTIME</em></p>
</li>
<li>
<p>Impute NA with mean value for all numerical variables</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;EDREGTIME&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;EDREGTIME&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">fillna</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;EDOUTTIME&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;EDOUTTIME&#39;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">fillna</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">df</span><span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#39;EDstay&#39;</span><span style="color:#000;font-weight:bold">]</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">to_datetime</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">EDOUTTIME</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">-</span> <span style="color:#000">pd</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">to_datetime</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">df</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">EDREGTIME</span><span style="color:#000;font-weight:bold">)</span>
     
<span style="color:#204a87;font-weight:bold">from</span> <span style="color:#000">sklearn.impute</span> <span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">SimpleImputer</span>
<span style="color:#000">imp</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">SimpleImputer</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">strategy</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#4e9a06">&#39;mean&#39;</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">imp</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">fit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">X_train</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">X_train1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">imp</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">transform</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">X_train</span><span style="color:#000;font-weight:bold">)</span>
<span style="color:#000">X_test1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">imp</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">transform</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">X_test</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div></li>
</ul>
</li>
</ol>
<h4 id="-model-development">&gt; Model development</h4>
<p>We built total seven predictive models to classifier our outcome of interest. Models include dummy and logistic regression as baseline models, Navie Bayes, KNN, Xgboost, Random Forest, and SVM. These models all suitable for categorical outcomes. We evaluate each model using metric accuracy, weight F1 sorce, recall and precision on training set and testing set.</p>
<p>Model performances on training set:</p>
<p>




<div id="/plotly/table2.json" class="plotly" style="height:300px"></div>
<script>
Plotly.d3.json("/plotly/table2.json", function(err, fig) {
    Plotly.plot('\/plotly\/table2.json', fig.data, fig.layout, {responsive: true});
});
</script></p>
<p>Model performances on testing set:</p>


<div id="/plotly/table1.json" class="plotly" style="height:300px"></div>
<script>
Plotly.d3.json("/plotly/table1.json", function(err, fig) {
    Plotly.plot('\/plotly\/table1.json', fig.data, fig.layout, {responsive: true});
});
</script>
<p>Based on model performances on our testing set, we chose XgBoost model as our best model since it has the highest accuracy. It is worth to mention that random forest also performs well in test set with the same accuracy with Xgboost. However, random forest has the highest accuracy (0.99) on training set, which indicates a potential problem of overfitting.</p>
<p>For model development part, I built Naive Bayes and KNN classifier. Here I will go further about tuning parameter process of these two models.</p>
<ul>
<li>
<p>For GaussianNB classifer, there is only parameter could be tuned which is var_smoothing. It represents the portion of the largest variance of all features that is added to variance for calculation stability. Here I used grid search to do hyperparameters tuning of Naive Bayes. After tuning, the best estimator of var_smoothing equals 1.</p>
<div class="highlight"><pre style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#000">params1</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">{</span><span style="color:#4e9a06">&#39;var_smoothing&#39;</span><span style="color:#000;font-weight:bold">:</span><span style="color:#000">np</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">logspace</span><span style="color:#000;font-weight:bold">(</span><span style="color:#0000cf;font-weight:bold">0</span><span style="color:#000;font-weight:bold">,</span><span style="color:#ce5c00;font-weight:bold">-</span><span style="color:#0000cf;font-weight:bold">9</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">num</span><span style="color:#ce5c00;font-weight:bold">=</span><span style="color:#0000cf;font-weight:bold">100</span><span style="color:#000;font-weight:bold">)}</span>
<span style="color:#000">clf</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GaussianNB</span><span style="color:#000;font-weight:bold">()</span>
<span style="color:#000">clf_gs</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">GridSearchCV</span><span style="color:#000;font-weight:bold">(</span>
    <span style="color:#000">clf</span><span style="color:#000;font-weight:bold">,</span> 
    <span style="color:#000">params1</span><span style="color:#000;font-weight:bold">,</span> 
    <span style="color:#000">n_jobs</span><span style="color:#ce5c00;font-weight:bold">=-</span><span style="color:#0000cf;font-weight:bold">1</span><span style="color:#000;font-weight:bold">,</span> 
<span style="color:#000;font-weight:bold">)</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">fit</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">X_train</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000">y_train</span><span style="color:#000;font-weight:bold">)</span>
</code></pre></div></li>
<li>
<p>For KNN classifier, I chose 4 parameters to tune which include</p>
<ul>
<li>n_neighbor: number of neighbors to use. [3, 4, 5, &hellip;, 10]</li>
<li>leaf_size: this can affect the speed of the construction and query.  [30, 40, 50]</li>
<li>weights: weight function used in prediction. [&lsquo;uniform&rsquo;, &lsquo;distance&rsquo;]</li>
<li>p: power parameter for the Minkowski metric. p=1 is equivalent to using manhatten distance, and p=2 is equivalent to using euclidean distance. [1, 2]</li>
</ul>
<p>Data were scaled first since KNN algorithm is based on calculating distances.</p>
<p>After hyperparameter tuning, the best estimators are:</p>
<ul>
<li>
<p>n_neighbors: 10, leaf_size: 50, weights: &lsquo;uniform&rsquo;, p: 1</p>
<p>




<div id="/plotly/knn.json" class="plotly" style="height:400px"></div>
<script>
Plotly.d3.json("/plotly/knn.json", function(err, fig) {
    Plotly.plot('\/plotly\/knn.json', fig.data, fig.layout, {responsive: true});
});
</script></p>
</li>
</ul>
</li>
</ul>
<h4 id="-dashboard">&gt; Dashboard</h4>
<p>We established an interactive dashboard that comprised our exploratory data analysis, model development, model prediction using a calendar, and real-time online ML algorithm. Mainly use package <em>dash</em> and <em>plotly</em> to create this dashboard.</p>
<ul>
<li>
<p>File structure</p>
<p>The overall file structure looks like this</p>
<p><img src="/project/images/f_2.png" alt="1"></p>
<p>Different sections of webpages could be added by creating a new .py file under <em>apps</em> file. All data that may be used in creating figures are put under <em>Data</em> file</p>
</li>
<li>
<p>Homepage</p>
<p>Our dashboard homepage looks like this. You can access to the original dataset and our source code about this dashboard and project from the links.</p>
</li>
</ul>
<p>​		<img src="/project/images/f_4.png" alt="1"></p>
<ul>
<li>
<p>EDA</p>
<p>For EDA part, I created summary statistics table of all categorical and numerical variables and also a stacked bar plot along with. Additional dropdown is added to choose between difference variable distributions that audience may be interested in.</p>
<p>




<div id="/plotly/table3.json" class="plotly" style="height:300px"></div>
<script>
Plotly.d3.json("/plotly/table3.json", function(err, fig) {
    Plotly.plot('\/plotly\/table3.json', fig.data, fig.layout, {responsive: true});
});
</script></p>


<div id="/plotly/bar.json" class="plotly" style="height:400px"></div>
<script>
Plotly.d3.json("/plotly/bar.json", function(err, fig) {
    Plotly.plot('\/plotly\/bar.json', fig.data, fig.layout, {responsive: true});
});
</script>
</li>
</ul>
<h4 id="-deploy-our-dashboard-to-gcp">&gt; Deploy our dashboard to GCP</h4>
<p>Finally, <em>Zhenhui Xu</em> helped deploy our dashboard to Google Cloud Platform. Now, everyone could access to our dashboard <a href="https://bios823-mimic-dashboard.ue.r.appspot.com/">here</a>! :)</p>
<h3 id="what-i-learned-from-this-project">What I learned from this project</h3>
<p>This final project provides me a good oppurtunity to work with EHR data, and a good practice to combine knowledge learned from the class with real data implementation as well. The most interesting part of this project for me is to establish our dashboard. Filled the dashboard gradually with organized visualizations gives me a sense of achievement. I also had deeper understanding of hyperparameters tuning through completing this project.</p>
<h3 id="references">References</h3>
<ol>
<li>Plotly website <a href="https://plotly.com/">https://plotly.com/</a></li>
<li>Our github repo <a href="https://github.com/biostats823-final-project/MIMIC-Predictive-Modeling">https://github.com/biostats823-final-project/MIMIC-Predictive-Modeling</a></li>
</ol>
<ul class="pa0">
  
</ul>
<div class="mt6 instapaper_ignoref">
      
      
      </div>
    </div>

    <aside class="w-90-l mt6-l">




</aside>

  </article>

    </main>
    <footer class="bg-navy bottom-0 w-100 pa3" role="contentinfo">
  <div class="flex justify-between">
  <a class="f4 fw4 hover-white no-underline white-70 dn dib-ns pv2 ph3" href="https://zhhmyz.github.io/" >
    &copy;  Mengyue Han 2020 
  </a>
    <div>








<a href="https://github.com/zhhmyz/zhhmyz.github.io" target="_blank" class="link-transition github link dib z-999 pt3 pt0-l mr1" title="Github link" rel="noopener" aria-label="follow on Github——Opens in a new window">
  <svg  height="32px"  style="enable-background:new 0 0 512 512;" version="1.1" viewBox="0 0 512 512" width="32px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
  <path d="M256,32C132.3,32,32,134.8,32,261.7c0,101.5,64.2,187.5,153.2,217.9c11.2,2.1,15.3-5,15.3-11.1   c0-5.5-0.2-19.9-0.3-39.1c-62.3,13.9-75.5-30.8-75.5-30.8c-10.2-26.5-24.9-33.6-24.9-33.6c-20.3-14.3,1.5-14,1.5-14   c22.5,1.6,34.3,23.7,34.3,23.7c20,35.1,52.4,25,65.2,19.1c2-14.8,7.8-25,14.2-30.7c-49.7-5.8-102-25.5-102-113.5   c0-25.1,8.7-45.6,23-61.6c-2.3-5.8-10-29.2,2.2-60.8c0,0,18.8-6.2,61.6,23.5c17.9-5.1,37-7.6,56.1-7.7c19,0.1,38.2,2.6,56.1,7.7   c42.8-29.7,61.5-23.5,61.5-23.5c12.2,31.6,4.5,55,2.2,60.8c14.3,16.1,23,36.6,23,61.6c0,88.2-52.4,107.6-102.3,113.3   c8,7.1,15.2,21.1,15.2,42.5c0,30.7-0.3,55.5-0.3,63c0,6.1,4,13.3,15.4,11C415.9,449.1,480,363.1,480,261.7   C480,134.8,379.7,32,256,32z"/>
</svg>

<span class="new-window"><svg  height="8px"  style="enable-background:new 0 0 1000 1000;" version="1.1" viewBox="0 0 1000 1000" width="8px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" >
<path d="M598 128h298v298h-86v-152l-418 418-60-60 418-418h-152v-86zM810 810v-298h86v298c0 46-40 86-86 86h-596c-48 0-86-40-86-86v-596c0-46 38-86 86-86h298v86h-298v596h596z" style="fill-rule:evenodd;clip-rule:evenodd;fill:;"/>
</svg>
</span></a>







</div>
  </div>
</footer>

    

  <script src="/dist/js/app.3fc0f988d21662902933.js"></script>


  </body>
</html>
